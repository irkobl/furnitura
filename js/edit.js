"use strict";define("widget-imagezoom-edit",["jquery","widget-imagezoom-view","widget","_","i18n","editor1","usercrop","panelDialog","htmlToPlainText","css!/css/require/widgets/imagezoom.css"],function(e,t,o,i,n,a,l,s,r){var u={minCols:2,editBtnClass:"ul-w-imagezoom-edit-btn",editorDescription:function(){return function(){var e=this;e.setPlaceholder()}}(),init:function(){return function(){}}(),initView:function(){return function(o,i){var n=this;return t.open(o,i),0==n.$el.length?void console.log("widget not exists on page "+o):(e(window).off(".imagezoomResize"),void e(window).on("resizeAllWidgets.imagezoomResize",function(){require(["cropModes"],function(e){e.recalcAll()})}))}}(),edit:function(){return function(){var t=this,o=e(".js-alt",t.$el);t.overlay.show({$el:t.$el,autohide:!1,asyncBeforeClose:function(){return function(){l.close(t.$el)}}(),close:function(){return function(){a.off("imageEvent"),s.hide()}}()}),s.show({context:t,required:["widget-imagezoom-form"],templateData:{data:t.data,opts:t.options},templateUrl:"/widgets/imagezoom/html/edit.html",afterOpen:function(){return function(){}}()}),"bottom"!=t.options.altPosition&&o.hide(),o.on("mousedown",function(){t.$el.hasClass("ul-openedTitlePopup")||l.event("openTitlePopup")}),t.$el.css("height","auto").find(".ul-w-imagezoom-img-wrap").addClass("ul-w-imagezoom-img-wrap-editting"),l.init({$el:t.$el,autoOpen:!0,openAfterChange:!0,afterClose:function(){return function(){var e=l.get(t.$el);t.data.cutData=e.cutData,t.data.originalImg=e.original,t.data.autocrop=e.autocrop,t.data.usercrop=e.usercrop,t.options.proportion=e.zoomaway,e.changed&&(t.data.parentStyle=""),t.update(),t.overlay.hide()}}(),titleSettings:{setData:function(){return function(e){e({position:t.options.label?t.options.altPosition:"invisible"})}}(),onOpen:function(){return function(){o.show(),t.setPlaceholder(),a.on({initForEls:".ul-w-imagezoom .js-title-editable",defaultTag:"span",placeholder:n("constructor.begin write"),simpleText:!0,inlineControls:["bold","italic","underline","strike"],leftPanelControls:!1,useEnter:!1,autosave:0,links:!1,textlimit:100,eventsNamespace:"imageEvent",save:function(){return function(e){t.data.alt=e.replace(/\&nbsp\;/,"").trim(),t.save()}}()}),t.$el.addClass("ul-openedTitlePopup")}}(),onClose:function(){return function(){a.off("imageEvent"),t.data.alt.length||o.hide(),"bottom"!=t.options.altPosition&&o.hide(),t.$el.removeClass("ul-openedTitlePopup")}}(),onChange:function(){return function(i,n){"over"==i.position?(e(".js-w-popupTitle-show",n).show(),1==i.positionHover&&(i.position="hover")):e(".js-w-popupTitle-show",n).hide();var a={bottom:"ul-w-imagezoom-title",hover:"ul-w-imagezoom-title-hover",over:"ul-w-imagezoom-title-hover -over",invisible:"ul-w-imagezoom-title invisible"},l={bottom:"note",hover:"normal",over:"normal",invisible:""};t.options.altPosition=i.position,t.options.label="invisible"!=i.position,o.find("div").removeClass(l.bottom).removeClass(l.hover).removeClass(l.over).removeClass(l.invisible).addClass(l[t.options.altPosition]),o.removeClass(a.bottom).removeClass(a.hover).removeClass(a.over).removeClass(a.invisible),o.addClass(a[t.options.altPosition]).show()}}()},seoSettings:{setData:function(){return function(e){e({alt:t.data.imageAlt,altPlaceholder:r(t.data.alt,"","filter"),title:t.data.imageTitle})}}(),onChange:function(){return function(e){t.data.imageAlt=e.alt,t.data.imageTitle=e.title}}()}})}}(),update:function(){return function(e){var t=this;e||(e=function(){return function(){}}());var o=t.$el.height();t.save(function(){t.render(function(){t.$el.css("height",o),t.setPlaceholder(),e()})})}}(),setPlaceholder:function(){return function(){var t=this;a.insertPlaceholder({$el:e(".js-title-editable",t.$el),placeholder:n("constructor.begin write"),tag:"span"})}}(),autocrop:function(){return function(e){this.data.autocrop=e[0].autocrop,this.__save()}}(),_changeClassClickOpt:function(){return function(){var e="-none";this.options.event&&"link"===this.options.click?e="-link":this.options.event&&"lightbox"===this.options.click&&(e="-lightbox"),this.$el.find(".ul-w-wrap").removeClass("ul-w-imagezoom-type-none").removeClass("ul-w-imagezoom-type-link").removeClass("ul-w-imagezoom-type-lightbox").addClass("ul-w-imagezoom-type"+e)}}(),destroy:function(){return function(){e(window).off(".imagezoomResize"),this.$el&&(this.$el.empty(),this.$el.remove(),this.$el=null)}}()};return u});
//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map

//# sourceMappingURL=edit.js.map
