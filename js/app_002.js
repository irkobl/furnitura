"use strict";function _asyncToGenerator(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function o(n,i){try{var a=e[n](i),s=a.value}catch(l){return void r(l)}return a.done?void t(s):Promise.resolve(s).then(function(t){o("next",t)},function(t){o("throw",t)})}return o("next")})}}var _Mathround=Math.round,_Mathabs=Math.abs,_Mathmin=Math.min,_Mathmax=Math.max,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};define("js/share/constants",[],function(){return{widgetVersion:{REACT:2,REACT_WRAPPER:1}}}),define("browserSupport",["bowser","modernizr"],function(t){var e=function(){var e={init:function(){return function(){if(window.isBrowserGraylisted&&!window.browserSupportIgnored){var t=e.checkIsNotOldSchool();t&&(t=e.checkIsNotMobile()),t&&e.checkHasFeatures()}}}(),checkIsNotOldSchool:function(){return function(){var t;return[].forEach?t=!0:(t=!1,window.location.href="/browser_support_fail"),t}}(),checkIsNotMobile:function(){return function(){var r,o=!1,n=[];return(t.tablet||t.mobile)&&(o=!0,n.push("mobile or tablet device")),o?(console.log("browser support errors: "+JSON.stringify(n)),r=!1,require(["i18n"],function(t){e.showModal(t("all.not optimized for mobile devices"),t("all.for stable workflow use desktop computer")+'<p style="text-align: center;margin-top: 20px;"><img src="/img/laptop.png"></p>',t("all.continue anyway"))})):r=!0,r}}(),checkHasFeatures:function(){return function(){var t,r=!1,o=[],n=window.Modernizr;for(var i in n)"boolean"==typeof n[i]&&0==n[i]&&(r=!0,o.push(i));return r?(console.log("browser support errors: "+JSON.stringify(o)),t=!0,require(["i18n","text!/html/constructor/browserSupport.html","css!/css/browserSupport.css"],function(t,r){e.showModal(t("all.your browser not supported yet"),t("all.for stable workflow we recommend")+r,t("all.continue anyway"))})):t=!1,t}}(),showModal:function(){return function(t,e,r){require(["nf"],function(o){o.confirm({title:t,text:e,ok:r,okCb:function(){return function(){window.location.href+="?ignoreBrowserSupport=true"}}()})})}}()};return{init:e.init}}();return e}),require(["js/share/constants","browserSupport","ul-error","core"],function(t,e){for(var r in t)t.hasOwnProperty(r)&&(window[r]=t[r]);e.init(),require(["U","panel","panelDialog","page","ul-framework","nf","i18n","logActions","browser-id","projectCopyrightBanner"],function(t,e,r,o,n,i,a,s,l,u){window.UU=t,window.UU.menu=e,window.UU.page=o,e.init(),r.init({menu:e}),o.init(e),u.init();var c=new n.tooltip;if(c.init("[title]:not(iframe)"),window.checkAdblock||i.notify(a("constructor.adblock detected",window.location.host),"info",{timeout:15e3,actions:[]}),$(document).on("keydown",function(t){return 8===t.keyCode?"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||$(t.target).closest("[contenteditable]").length:void 0}),t.params.site&&t.params.pageId&&t.hist._init(function(){var e;return e=window.constructorPreviewMode?{data:{url:"/sites/url/"+t.params.site+"/pages/id/"+t.params.pageId+"/preview",panel:"panelPreview"},title:"preview",url:"/sites/url/"+t.params.site+"/pages/id/"+t.params.pageId+"/preview"}:{data:{url:"/sites/url/"+t.params.site+"/pages/id/"+t.params.pageId+"/edit"},title:"title",url:"/sites/url/"+t.params.site+"/pages/id/"+t.params.pageId+"/constructor"}}(),function(t){return t.panel?void e.setPanel(t.panel):($('.js-preview-action[data-mode="back"]',".ul-preview-mode").trigger("click"),void o.setPage(t.url))}),window.localStorage.backupRestoreMsg)try{var d=JSON.parse(window.localStorage.backupRestoreMsg);d.site==t.params.site&&setTimeout(function(){i.notify(a("constructor.backup restored")),delete window.localStorage.backupRestoreMsg},500)}catch(p){console.log(p)}if(!window.developmentMode){var f=!0,h=window.attachEvent||window.addEventListener,g=window.attachEvent?"onbeforeunload":"beforeunload";h(g,function(t){return f?((t||window.event).returnValue="Are you sure to leave the page",(t||window.event).returnValue+""):void 0}),document.addEventListener("mousedown",function(){f=!1}),document.addEventListener("disableUnloadAlert",function(){f=!1}),document.addEventListener("mouseup",function(){setTimeout(function(){f=!0},200)})}s.add({fromFile:"js/constructor/app.js",title:"constructor load",desc:"site: "+t.params.site+". pageId: "+t.params.pageId}),(new l).saveIdToCookie()})}),define("js/constructor/app",function(){}),define("history",["U","waitall","asyncjs","enqueueAjax","jquery","i18n","nf","ul-error"],function(t,e,r,o,n,i,a,s){var l={title:i("all.oldPage")("title"),text:i("all.oldPage")("text"),ok:i("all.oldPage")("okBtnText"),okCb:function(){return function(){window.location.reload()}}()},u={title:i("all.ajaxError")("title"),text:i("all.ajaxError")("text"),ok:i("all.ajaxError")("okBtnText"),okCb:function(){return function(){window.location.reload()}}()},c={title:i("all.timeoutError")("title"),text:i("all.timeoutError")("text"),ok:i("all.timeoutError")("okBtnText"),okCb:function(){return function(){window.location.reload()}}()},d=function(){return function(t){return function(e){e.session_error?a.confirm(l):e.version_error?a.confirm(u):t.call(this,e)}}}();return{cursor:null,states:[],forwardStates:[],curAtomic:null,stackAtomic:0,actions:{},regAction:function(){return function(t,e){this.actions[e.act]={a:e,me:t}}}(),animateState:function(){return function(t){var o=this;if(t.undo&&t.redo)return t;if("atomic"==t.act){var n=t.data,i=n.slice(0).reverse();return{id:t.id,server:!0,act:"atomic: "+n.map(function(t){return t.act}).join(","),undo:function(){return function(t){r.mapSeries(i,function(t,r){e(o.animateState(t).undo,r)},t())}}(),redo:function(){return function(t){r.mapSeries(n,function(t,r){e(o.animateState(t).redo,r)},t())}}()}}var a=o.actions[t.act];return{id:t.id,server:!0,act:t.act,undo:function(){return function(e){return a.a.undo(a.me,t.data,e)}}(),redo:function(){return function(e,r){return a.a.redo(a.me,t.data,e,r)}}()}}}(),clearState:function(){return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};this.states=[],this.forwardStates=[],t(),n(document).trigger("historyBtnsLight")}}(),pageChanged:function(){return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};this.clearState(t)}}(),pushState:function(){return function(t){return this.curAtomic?this.curAtomic.push(JSON.parse(JSON.stringify(t))):(this.send("push",t),this.states.push(this.animateState(t)),0<this.forwardStates.length&&(this.forwardStates=[]),void n(document).trigger("historyBtnsLight"))}}(),pushAndExec:function(){return function(t,r){var o=this;this.beginAtomic(),this.pushState(t);var n=o.animateState(t);return e(function(t){return n.redo(t,!0)},function(){o.endAtomic(),r&&r()})}}(),beginAtomic:function(){return function(){var t=this,e=t.stackAtomic;++t.stackAtomic,e||(o(null,{action:"beginAtomic"}),t.curAtomic=[])}}(),endAtomic:function(){return function(){var t=this;if(--t.stackAtomic,!t.stackAtomic){var e=t.curAtomic;if(t.curAtomic=null,e.length){var r={act:"atomic",server:!0,data:e};t.send("push",r),t.states.push(t.animateState(r)),0<t.forwardStates.length&&(t.forwardStates=[]),n(document).trigger("historyBtnsLight")}o(null,{action:"endAtomic"})}}}(),discardAtomic:function(){return function(){--this.stackAtomic,this.stackAtomic||(this.curAtomic=null,o(null,{action:"endAtomic"}))}}(),queue:[],enqueue:function(){return function(t){var e=this,r=function(){return function(){t(function(){e.queue.shift(),e.queue.length&&e.queue[0]()})}}();e.queue.push(r),1==e.queue.length&&e.queue[0]()}}(),asAtomic:function(){return function(t){this.beginAtomic(),t(),this.endAtomic()}}(),undo:function(){return function(){var t=this;t.enqueue(function(r){if(0==t.states.length)return r();var o=t.states.pop();o.server&&t.send("push"),n(document).trigger("historyBtnsLight"),t.beginAtomic(),e(o.undo,function(){t.discardAtomic(),t.forwardStates.push(o),n(document).trigger("historyBtnsLight"),r()})})}}(),redo:function(){return function(){var t=this;t.enqueue(function(r){if(0==t.forwardStates.length)return r();var o=t.forwardStates.pop();o.server&&t.send("push"),n(document).trigger("historyBtnsLight"),t.beginAtomic(),e(o.redo,function(){t.discardAtomic(),t.states.push(o),n(document).trigger("historyBtnsLight"),r()})})}}(),sendQueue:r.queue(function(t,e){t(e)},1),send:function(){return function(e,r,l){var u=this;if(!u._stopQueue){var p=t.params.site,f=t.params.page,h=t.params.lastId,g=function(){return function(t){u.sendQueue.push(function(r){var o,g=function(){return function(t,e,r,n,i){return e>=t?(setTimeout(function(){o(t,e)},50*t),void++t):(a.confirm(c),u._stopQueue=!0,r(i),void(n&&n(i,null)))}}();(o=function(){return function(o,c){n.ajax({url:"/sites/url/"+p+"/pages/id/"+f+"/history/"+e+"?lastId="+h,type:"post",data:{dataFromAjaxEnqueue:JSON.stringify(t)},doNotShowAjaxError:!0}).success(d(function(e){return e[1]&&Array.isArray(e[1])?(r(null),l&&l(null,[e[0],e[1].shift()]),void t.forEach(function(t){if(t.data&&t.data.queries){var r=JSON.parse(t.data.queries)[0];r&&r.__sendCb&&n(document).trigger("sendPush-"+r.__sendCb,r)}var o=e[1].length?e[1].shift():null;t.cb&&t.cb(o.err,o.data)})):(u._stopQueue=!0,s.sendErrorOnServer({msg:"[History] Data 1 is not defined",data:e}),void a.confirm({title:i("all.ajaxError")("title"),text:i("all.ajaxError")("text"),ok:i("all.ajaxError")("okBtnText"),okCb:function(){return function(){window.location.reload()}}()}))})).error(function(t){c=504==t.status||408==t.status?c:0,g(o,c,r,l,t)})}}())(0,10)})}}();o(null,{action:"setCallBack",callBack:g,comand:e})}}}()}}),define("model/pages",["jquery","_","U"],function(t,e,r){return{pages:null,templateBlanks:null,copy:function(){return function(e,o,n,i){var a=this;t.ajax({url:"/sites/url/"+e+"/pages/id/"+o+"/copy",type:"GET",api:!0,ok:function(){return function(t){a.load(e,function(){a.pages.push(t.page),r.params.pages.push(t.page),n(t.page)})}}(),noOk:function(){return function(t){i(t)}}(),error:function(){return function(){require(["nf"],function(t){t.notify("Произошла ошибка","error")})}}()})}}(),create:function(){return function(e,o,n,i){var a=this;t.ajax({url:"/sites/url/"+e+"/pages",type:"POST",data:o,api:!0,ok:function(){return function(t){null===t?i(t):(r.params.pages.push(t.page),a.pages.push(t.page),n(t.page))}}(),noOk:function(){return function(t){i(t)}}(),error:function(){return function(){require(["nf"],function(t){t.notify("Произошла ошибка","error")})}}()})}}(),edit:function(){return function(e,o,n,i,a){var s=this;t.ajax({url:"/sites/url/"+e+"/pages/id/"+o,type:"POST",data:n,api:!0,ok:function(){return function(e){"index"===o&&(e.useCommonMetaImage=n.useCommonMetaImage,r.params.commonMetaImage=e.useCommonMetaImage?e.meta.image:""),t(s.pages).each(function(t,r){return r._id==n._id?(s.pages[t]=e,!1):void 0}),i(e)}}(),noOk:function(){return function(t){a(t)}}(),error:function(){return function(){require(["nf"],function(t){t.notify("Произошла ошибка","error")})}}()})}}(),getPageBlank:function(){return function(t){return{_id:"",id:"",title:t||"Страница",template:"index",meta:{image:"",description:"",keywords:[]}}}}(),get:function(){return function(t,e,r){var o=this;if(o.pages){var n=o.pages.filter(function(t){return t._id===e})[0];r(n)}else o.load(t,function(){var t=o.pages.filter(function(t){return t._id===e})[0];r(t)})}}(),getPageBlanks:function(){return function(e,r){var o=this;o.templateBlanks?r(null,o.templateBlanks):t.get("/sites/url/"+e+"/templatePages").success(r.ok(function(t){o.templateBlanks=t.pages,r(null,o.templateBlanks)})).error(r)}}(),load:function(){return function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){},o=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=this;return n.isPageDeleting?void setTimeout(function(){n.load(e,r)},50):!n.pages||o?t.ajax({url:"/sites/url/"+e+"/pages",type:"GET",api:!0,ok:function(){return function(t){return n.pages=t.pages.map(function(t){return t.type=t._type||"common",t}),r(n.pages),n.pages}}(),noOk:function(){return function(t){throw t}}()}):(r(n.pages),[null,{pages:n.pages}])}}(),remove:function(){return function(r,o,n){var i=this;i.isPageDeleting=!0,require(["nf"],function(a){t.ajax({url:"/sites/url/"+r+"/pages/id/"+o+"/delete",type:"POST",api:!0,ok:function(){return function(t){i.pages=e.reject(i.pages,function(t){return t.id==o}),n(t)}}(),noOk:function(){return function(){a.notify("Произошла ошибка","error")}}(),error:function(){return function(){a.notify("Произошла ошибка","error")}}()}).always(function(){i.isPageDeleting=!1})})}}(),savePagesOrder:function(){return function(e,r,o){require(["nf"],function(n){t.ajax({url:"/sites/url/"+r+"/pages/order",type:"POST",api:!0,data:{order:e},ok:function(){return function(){o()}}(),noOk:function(){return function(){n.notify("Произошла ошибка","error")}}(),error:function(){return function(){n.notify("Произошла ошибка","error")}}()})})}}(),getAllPages:function(){return function(){return this.pages}}()}}),define("js/ulib/ulLoader/progressModel",[],function(){var t=function(){return function(t){this._estimate=1500/_Mathmax(2e3,t.estimate||2e3),this._formula=function(t){return.12*Math.log(t*this._estimate+1)},this._startTime=null,!1!==t.auto&&this.start()}}();return t.prototype={start:function(){return function(){this._startTime=Date.now()}}(),stop:function(){return function(){this._startTime=null}}(),get value(){if(null===this._startTime)return 0;var t=Date.now()-this._startTime;return _Mathmin(1,this._formula(t))}},t}),function(t){if("function"==typeof define&&define.amd)define("js/ulib/ulLoader/defaultOptions",[],t);else{if("object"!==("undefined"==typeof exports?"undefined":_typeof(exports)))throw new Error("Unexpected environment");module.exports=t()}}(function(){return{isBlurring:!1,isShowPanel:!1,isShowProgressBar:!1,img:!1,title:"constructor.title",text:"constructor.text"}}),define("page",["jquery","U","posFixed","nf","i18n","history","_","logActions","ulLoader","typography","colorThemeHelper"],function(t,e,r,o,n,i,a,s,l){var u=null,c={position:"",deny:!1,init:function(){return function(o){var n=this,i=this;u=o,i.intTopHandler=null,i.intBottomHandler=null,i.$dropTarget=null,i.$el=t("#ul-main"),window.signals.setPage.listen(function(t){return new Promise(function(e){n._realSetPage.apply(n,t),e()})}),i.setPage(e.params.pageUrl,function(){r.init("#ul-main"),i.doc=window.document,i.w=window,i.dragEl=!1,i.prevAbsSize={},i.top=i.$el.offset().top,i.left=i.$el.offset().left,i.width=i.$el.width(),i.height=i.$el.height(),t(i.$el).on("click","a",function(e){e.preventDefault();var r=t(e.target),o=r.attr("href");if(r.hasClass("ul-nav-link")){var n=o.split("/");o="/sites/url/"+n[1]+"/pages/id/"+n[2]+"/edit",i.setPage(o)}}),l.hide()})}}(),getClosestEl:function(){return function(e,r,o){var n,i,a,s,l,u,c,d,p=this,f=null,h=[],g=!1,m=parseInt(p.$el.scrollTop()),v=parseInt(p.$el.scrollLeft());return t.each(o,function(t,o){var n={top:parseInt(o.top+m),left:parseInt(o.left+v),bottom:parseInt(o.height+o.top+m),right:parseInt(o.width+o.left+v)};e>=n.left&&e<=n.right&&r>=n.top&&r<=n.bottom&&(h.push(o.$el),f=o.$el)}),h.length?h.forEach(function(t){return t.hasClass("ul-widget")?(f=t,!1):void 0}):t.each(o,function(t,o){var p={top:parseInt(o.top+m),left:parseInt(o.left+v),bottom:parseInt(o.height+o.top+m),right:parseInt(o.width+o.left+v)};l=_Mathmax(e,p.left),u=_Mathmin(e,p.right),c=_Mathmax(r,p.top),d=_Mathmin(r,p.bottom),n=l-u,i=c-d,s=Math.sqrt(n*n+i*i),void 0!=a&&!(a>s)||o.$el.hasClass("ul-drop-remove")||o.$el.is("header")||o.$el.is("footer")||(a=s,g=!0,f=o.$el)}),{$el:f,scrollTop:m,scrollLeft:v,isOuter:g}}}(),closestToCoords:function(){return function(t,e){if(!e||!e.length)return null;var r=this,o=null,n=parseInt(t.left+r.$el.scrollLeft()),i=parseInt(t.top+r.$el.scrollTop()),a={},s=null,l=15;if(a=r.getClosestEl(n,i,e),o=a.$el,!o||!o.length||!o.offset())return o&&!o.offset()&&require(["ul-error"],function(t){t.sendErrorOnServer({msg:"UKT-5404 closestToCoords. $el.offset underfined.",dragEl:o,dragEllength:o.length,elFind:a,$collection:e})}),null;if(o.hasClass("ul-drop-remove")||o.hasClass("ul-drop-placeholder"))return o;if(!o.hasClass("ul-container"))var u=!!o.closest(".ul-row").length&&_Mathabs(o.closest(".ul-row").offset().top+a.scrollTop-i),c=!!o.closest(".ul-row").length&&_Mathabs(o.closest(".ul-row").offset().top+a.scrollTop+o.closest(".ul-row").height()-i),d=!!o.closest(".ul-row").length&&_Mathabs(o.closest(".ul-row").offset().left+a.scrollLeft-n),p=!!o.closest(".ul-row").length&&_Mathabs(o.closest(".ul-row").offset().left+a.scrollLeft+o.closest(".ul-row").width()-n);if(!o.is("header")&&!o.hasClass("ul-drop-remove")&&!o.is("footer")){(!o.hasClass("ul-container")&&"top"==r.position&&l>=u||"bottom"==r.position&&l>=c||"bottom"==r.position&&l>=u||"top"==r.position&&l>=c)&&(o=o.closest(".ul-row")),s={top:parseInt(o.offset().top+a.scrollTop),left:parseInt(o.offset().left+a.scrollLeft),bottom:parseInt(o.height()+o.offset().top+a.scrollTop),right:parseInt(o.width()+o.offset().left+a.scrollLeft)};var f=_Mathabs(s.left-n),h=_Mathabs(s.right-n),g=_Mathabs(s.top-i),m=_Mathabs(s.bottom-i);if(a.isOuter)p>d?c>u?d>u?r.position="top":r.position="left":d>c?r.position="bottom":r.position="left":d>p&&(m>u?p>u?r.position="top":r.position="right":p>c?r.position="bottom":r.position="right"),(u&&c&&"top"==r.position&&l>=u||"bottom"==r.position&&l>=c||a.isOuter)&&(o="left"==r.position||"right"==r.position?o.closest(".ul-col"):o.closest(".ul-row"));else{h>f?m>g?f>g?r.position="top":r.position="left":f>m?r.position="bottom":r.position="left":f>h&&(m>g?h>g?r.position="top":r.position="right":h>m?r.position="bottom":r.position="right");var v=null;o.hasClass("ul-col")&&o.children(".ul-widget").length&&(v=_Mathabs(o.children(".ul-widget").last().offset().top+o.children(".ul-widget").last().height()+a.scrollTop-i),m>v&&f>v&&h>v&&(o=o.children(".ul-widget").last(),r.position="bottom"))}}return o}}(),closestToCoordsAbs:function(){return function(t,e){if(!e.length)return null;var r=this,o=parseInt(t.left+r.$el.scrollLeft()),n=parseInt(t.top+r.$el.scrollTop());return r.getClosestEl(o,n,e,null).$el}}(),content:function(){return function(){var t=this;return t.$el.content()}}(),dropCollectionToOffsetObjects:function(){return function(){var e=c;e.$droppableCollection=t(e.$droppableCollection).map(function(t,e){return{$el:e.$el,top:parseInt(e.$el.offset().top),left:parseInt(e.$el.offset().left),height:parseInt(e.$el.outerHeight()),width:parseInt(e.$el.outerWidth())}})}}(),deselectDroppable:function(){return function(){var e=this;e.ulDropSetDeny(!1),t(".ul-absolute-widgets").removeClass("ul-drop-absolute-hover"),t(".ul-fake-drop-position-absolute").removeClass("ul-drop-absolute-hover"),t(".ul-drop-top").removeClass("ul-drop-top"),t(".ul-drop-bottom").removeClass("ul-drop-bottom"),t(".ul-drop-left").removeClass("ul-drop-left"),t(".ul-drop-right").removeClass("ul-drop-right"),t(".ul-drop-all").removeClass("ul-drop-all"),t(".ul-drop-all-block").removeClass("ul-drop-all-block"),t(".ul-drop-container-top").removeClass("ul-drop-container-top"),t(".ul-drop-container-bottom").removeClass("ul-drop-container-bottom"),t(".ul-headerFooter-controls-visible").removeClass("ul-headerFooter-controls-visible"),e.$el.off("scroll.onDragEl")}}(),clearDropPos:function(){return function(){var e=this;e.$dropTarget.hasClass("ul-drop-"+e.position)&&e.$dropTarget.hasClass("ul-drop-all")&&e.$dropTarget.hasClass("ul-drop-all-block")||(e.ulDropSetDeny(!1),t(".ul-absolute-widgets").removeClass("ul-drop-absolute-hover"),t(".ul-container").removeClass("ul-block-dragOver"),t(".ul-drop-top").removeClass("ul-drop-top"),t(".ul-drop-bottom").removeClass("ul-drop-bottom"),t(".ul-drop-left").removeClass("ul-drop-left"),t(".ul-drop-right").removeClass("ul-drop-right"),t(".ul-drop-all").removeClass("ul-drop-all"),t(".ul-drop-all-block").removeClass("ul-drop-all-block"),t(".ul-drop-container-top").removeClass("ul-drop-container-top"),t(".ul-drop-container-bottom").removeClass("ul-drop-container-bottom"),t(".ul-drop-remove").removeClass("ul-hovered-drop-remove-el"),t(".ul-drop-placeholder").removeClass("ul-drop-all"),t(".ul-headerFooter-controls-visible").removeClass("ul-headerFooter-controls-visible"))}}(),ulDropSetDeny:function(){return function(e){["ul-drop-top","ul-drop-bottom","ul-drop-left","ul-drop-right","ul-drop-all"].forEach(function(r){var o=r+"-deny",n=e?o:r;t("."+r+", ."+o).removeClass(r).removeClass(o).addClass(n)})}}(),lastHover:null,startDrag:0,hover:function(){return function(t,e,r,o){var n=this,i=(new Date).getTime();(!n.lastHover||100<i-n.lastHover||1===n.startDrag)&&(1>n.startDrag&&(n.startDrag+=1),n.lastHover=i,n._hover(t,e,r,o))}}(),prevPos:null,$prevEl:null,$restoreEl:null,prevRow:!1,_hover:function(){return function(e,r,o,i){var s=this,l=e-s.left,u=r-s.top,c=!!s.constructor.widgetGlobal.dropPosition[i]&&!!s.constructor.widgetGlobal.dropPosition[i].fixed;if(s.ulDropSetDeny(!1),s.$dropTarget=c?s.closestToCoordsAbs({left:l,top:u},s.$droppableCollection):s.closestToCoords({left:l,top:u},s.$droppableCollection),null==s.$dropTarget)return!1;if(s.$prevEl&&!s.$prevEl.is("header")&&!s.$prevEl.is("footer")&&!s.$dropTarget.is("header")&&!s.$dropTarget.is("footer")&&s.$prevEl.attr("id")==s.$dropTarget.attr("id")&&s.position==s.prevPos&&s.prevRow==s.row)return void(s.$dropTarget=s.$restoreEl);if(s.$restoreEl=null,s.prevRow=!1,s.prevPos=s.position,s.$prevEl=s.$dropTarget,c)s.fixedDrop&&!s.$dropTarget.hasClass("ul-drop-remove")&&s.$dropTarget.hasClass("ul-absolute-widgets")&&(s.position=s.$dropTarget.hasClass("ul-position-absolute-bottom")?"bottom":s.$dropTarget.hasClass("ul-position-absolute-center")?"center":s.$dropTarget.hasClass("ul-position-absolute-top")?"top":"special",s.$dropTarget.children(".ul-widget").length&&s.$dropTarget.children(".ul-widget").attr("data-widget")!=i&&s.$dropTarget.attr("data-title",n("constructor.fixed replace")+" "+i),s.clearDropPos(),s.$dropTarget.addClass("ul-drop-absolute-hover")),s.$dropTarget.hasClass("ul-drop-remove")&&(s.position="bottom",s.clearDropPos(),s.$dropTarget.addClass("ul-hovered-drop-remove-el"));else{var d=!1;if("widget"!=o)s.$dropTarget.length||(s.$dropTarget=t("#"+s.$dropTarget.context.id)),(s.$dropTarget.is("header")||s.$dropTarget.is("footer"))&&(s.$dropTarget.parent().find(".ul-drop-placeholder").length&&!s.$dropTarget.parent().find(".ul-container").length&&(s.$dropTarget=s.$dropTarget.parent().find(".ul-drop-placeholder"),s.position="all ul-site-empty"),t('[class*="ul-drop-container"]').length&&(s.$dropTarget=t('[class*="ul-drop-container"]')),s.$dropTarget.is("header")?s.$dropTarget.parent().find(".ul-container").eq(0)&&(s.$dropTarget=s.$dropTarget.parent().find(".ul-container").eq(0),s.position="top"):s.$dropTarget.is("footer")&&(s.$dropTarget=s.$dropTarget.parent().find(".ul-container").eq(s.$dropTarget.parent().find(".ul-container").length-1),s.position="bottom")),s.$dropTarget.is("header")&&s.$dropTarget.is("footer")||(("top"==s.position||"bottom"==s.position)&&!s.$dropTarget.is("header")&&!s.$dropTarget.is("footer")&&("bottom"==s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().hasClass("ul-drop-container-top")?d=!0:"top"==s.position&&s.$dropTarget.prev().length&&s.$dropTarget.prev().hasClass("ul-drop-container-bottom")&&(d=!0),s.$dropTarget.hasClass("ul-el-drag-mask")?(d=!0,s.clearDropPos(),s.$dropTarget.addClass("ul-drop-all-block")):"bottom"===s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().hasClass("ul-el-drag-mask")?(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.next(),s.$dropTarget.addClass("ul-drop-all-block")):s.$dropTarget.prev().length&&"top"===s.position&&s.$dropTarget.prev().hasClass("ul-el-drag-mask")&&(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.prev(),s.$dropTarget.addClass("ul-drop-all-block")),!d&&(s.clearDropPos(),s.$dropTarget.addClass("ul-drop-container-"+s.position))),s.$dropTarget.hasClass("ul-drop-remove")?(s.clearDropPos(),s.$dropTarget.addClass("ul-hovered-drop-remove-el")):s.$dropTarget.hasClass("ul-drop-placeholder")&&(s.clearDropPos(),s.$dropTarget.addClass("ul-drop-all").addClass("ul-site-empty")));else{if(s.$dropTarget.is("header")||s.$dropTarget.is("footer")){var p=s.$dropTarget;if(s.clearDropPos(),p.find(".ul-headerFooter-controls").addClass("ul-headerFooter-controls-visible"),s.$dropTarget.is("header")){var f=s.$dropTarget.parent().find(".ul-container");f.length?(s.$dropTarget=f.eq(0),s.$dropTarget=s.$dropTarget.find(".ul-row").eq(0),s.position="top"):s.$dropTarget.parent().find(".ul-drop-placeholder").length&&(s.$dropTarget=s.$dropTarget.parent().find(".ul-drop-placeholder"),s.position="all ul-site-empty")}else if(s.$dropTarget.is("footer"))if(f=s.$dropTarget.parent().find(".ul-container"),f.length){var h=f.length-1,g=f.eq(f.length-1).find(".ul-row").length-1;s.$dropTarget=f.eq(h).find(".ul-row").eq(g),s.position="bottom"}else s.$dropTarget.parent().find(".ul-drop-placeholder").length&&(s.$dropTarget=s.$dropTarget.parent().find(".ul-drop-placeholder"),s.position="all ul-site-empty");s.$dropTarget.addClass("ul-drop-"+s.position)}else s.$dropTarget.hasClass("ul-col")&&!s.$dropTarget.children(".ul-widget").length||s.$dropTarget.hasClass("ul-widget")&&s.$dropTarget.hasClass("ul-el-drag-mask")||s.$dropTarget.hasClass("ul-drop-placeholder")?(s.clearDropPos(),s.$dropTarget.addClass("ul-drop-all"),s.$dropTarget.hasClass("ul-drop-placeholder")&&s.$dropTarget.addClass("ul-site-empty")):s.$dropTarget.hasClass("ul-drop-remove")?(s.clearDropPos(),s.$dropTarget.addClass("ul-hovered-drop-remove-el")):(s.$dropTarget.hasClass("ul-widget")?(("left"==s.position||"right"==s.position)&&(s.$dropTarget=s.$dropTarget.closest(".ul-col"),"right"==s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().hasClass("ul-drop-left")?d=!0:"left"==s.position&&s.$dropTarget.prev().length&&s.$dropTarget.prev().hasClass("ul-drop-right")?d=!0:"left"===s.position&&s.$dropTarget.prev().length&&s.$dropTarget.prev().children(".ul-el-drag-mask").length&&1===s.$dropTarget.prev().closest(".ul-col").children(".ul-widget").length?(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.prev().children(".ul-el-drag-mask"),s.$dropTarget.addClass("ul-drop-all")):"right"===s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().children(".ul-el-drag-mask").length&&1===s.$dropTarget.next().closest(".ul-col").children(".ul-widget").length&&(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.next().children(".ul-el-drag-mask"),s.$dropTarget.addClass("ul-drop-all"))),("bottom"==s.position||"top"==s.position)&&2>s.$dropTarget.closest(".ul-row").children(".ul-col").length&&2>s.$dropTarget.closest(".ul-row").children(".ul-col").children(".ul-widget").length&&(d=!1,s.$dropTarget=s.$dropTarget.closest(".ul-row")),"top"==s.position&&s.$dropTarget.prev().length&&s.$dropTarget.prev().hasClass("ul-drop-bottom")?(d=!0,s.$dropTarget=s.$dropTarget.prev()):"bottom"==s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().hasClass("ul-drop-top")&&(d=!0,s.$dropTarget=s.$dropTarget.next())):s.$dropTarget.hasClass("ul-row")?"top"==s.position&&s.$dropTarget.prev().length&&s.$dropTarget.prev().hasClass("ul-drop-bottom")?(d=!0,s.$dropTarget=s.$dropTarget.prev()):"bottom"==s.position&&s.$dropTarget.next().length&&s.$dropTarget.next().hasClass("ul-drop-top")&&(d=!0,s.$dropTarget=s.$dropTarget.next()):s.$dropTarget.hasClass("ul-col")&&("bottom"==s.position?s.$dropTarget=s.$dropTarget.parent():"left"===s.position&&s.$dropTarget.closest(".ul-col").children(".ul-el-drag-mask").length&&1===s.$dropTarget.closest(".ul-col").children(".ul-widget").length?(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.children(".ul-el-drag-mask"),s.$dropTarget.addClass("ul-drop-all")):"right"===s.position&&s.$dropTarget.closest(".ul-col").children(".ul-el-drag-mask").length&&1===s.$dropTarget.closest(".ul-col").children(".ul-widget").length&&(d=!0,s.clearDropPos(),s.$dropTarget=s.$dropTarget.children(".ul-el-drag-mask"),s.$dropTarget.addClass("ul-drop-all"))),d||(s.clearDropPos(),s.$dropTarget.addClass("ul-drop-"+s.position)));s.$dropTarget.is("header")||s.$dropTarget.is("footer")||s.$dropTarget.closest(".ul-container").addClass("ul-block-dragOver")}}if(s.deny=!1,"widget"==o){var m=s.constructor.widgetGlobal.minColsTable[i]||2;if(s.$dropTarget.hasClass("ul-widget")){var v=s.$dropTarget.parent(".ul-col"),b=0;v.closest(".ul-row").children(".ul-col").each(function(e,r){var o=t(r),n=s.constructor._getMinCols(o);b+=o.get(0)==v.get(0)?a.max([n,m]):n}),b>12&&(s.deny=!0)}s.$dropTarget.hasClass("ul-col")&&(v=s.$dropTarget,b=0,v.closest(".ul-row").children(".ul-col").each(function(e,r){var o=t(r);b+=s.constructor._getMinCols(o)}),b+m>12&&(s.deny=!0))}s.ulDropSetDeny(s.deny)}}(),getAndAppendDropPositionAbsWidget:function(){return function(){return t('<div id="special-0" class="ul-absolute-widgets ul-position-absolute-bottom ul-col" data-position="left"></div><div id="special-1" class="ul-absolute-widgets ul-position-absolute-bottom ul-col" data-position="right"></div><div id="special-2" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="left"></div><div id="special-3" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="right"></div><div id="special-4" class="ul-absolute-widgets ul-position-absolute-center ul-col" data-position="center"></div><div id="special-5" class="ul-absolute-widgets ul-position-absolute-special ul-col" data-position="left"></div><div id="special-6" class="ul-absolute-widgets ul-position-absolute-special ul-col" data-position="right"></div><div id="special-7" class="ul-absolute-widgets ul-position-absolute-top ul-col" data-position="right"></div>').appendTo(t("#ul-main #body-fict"))}}(),loadAbsWidgetConstructorModeAndReposition:function(){return function(e,r){var o=this;t.each(t("<div>"+e.absWidgets+"</div>").children(),function(e,n){"undefined"===t(n).attr("data-party")&&(t(n).data("data").positionWrap.right?(t(n).attr("data-party","right"),t(n).data().data.party="right"):(t(n).attr("data-party","left"),t(n).data().data.party="left"));var i=r.parent().find(".ul-position-absolute-"+t(n).data("position")+"[data-position="+t(n).data("party")+"]");o.constructor.widgetGlobal.proto.widgetAbsWrapSize(t(n)),i.append(n)}),o.constructor.repositionAbsWidget(),t.each(r,function(e,r){t(r).children(".ul-widget").length&&o.constructor.repositionAbsWidget(t(r))})}}(),isLocalStorageSupported:function(){var t="testSupportLocalStorage",e=window.localStorage;try{return e.setItem(t,t),e.removeItem(t),!0}catch(r){return console.log("Saving to storage problem. Change browser.",r),!1}}(),setPage:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(){var e=arguments;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.dispatch(window.actions.unloadPage(e));case 2:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),_realSetPage:function(){return function(r,a,l){var u=this;t(document).trigger("beforeChangePage",{url:e.params.page}),t.ajax({url:r,api:!0,doNotShowAjaxError:!0,ok:function(){return function(o){e.params.pageIsEditable=o.params.pageIsEditable,e.params.panelDefault=o.params.panelDefault;var n=o.params.styles.map(function(t){return t.match(/^http/)?(e.requireCss(t),null):t.match(/\.css(\?x=.*)?$/)?"css!"+t:"less!"+t}).filter(function(t){return null!=t});require(n,function(){require(["constructor"],function(n){s.add({fromFile:"js/constructor/page.js",title:"setPage start",desc:"url: "+r}),t("#body-fict").html(o.body).removeClass(function(t,e){return(e.match(/(^|\s)ul-page-\S+/g)||[]).join(" ")}).addClass("ul-page-"+o.params.pageType+"-"+o.params.pageId.replace(/^__/,"")),t.extend(e.params,o.params),window.dispatch(window.actions.loadPage(o.params.pageId)),t(document).trigger("changePage",{
url:e.params.page,template:e.params.template}),i.pageChanged(l),u.constructor=n;var c=u.getAndAppendDropPositionAbsWidget();u.loadAbsWidgetConstructorModeAndReposition(o,c),u.constructor.init(),u.constructor.setSiteSettings(null,o.pageParams.theme);var d=e.menu.$main.find(".icon-content-pages-blog");switch(o.params.pageType){case"common":case"special":d.hide();break;case"blog":d.show()}u.isLocalStorageSupported&&"common"===o.params.pageType&&o.params.pageIsEditable&&(localStorage.previousPageId=o.params.pageId),e.menu.$content.find('[data-single-widget="true"]').removeAttr("disabled"),o.singleWidgets&&(u.constructor.singleWidgets=o.singleWidgets,o.singleWidgets.forEach(function(e){t(window).trigger("singleWidget",{active:!1,wtype:e})})),a&&a({singleWidgets:o.singleWidgets}),s.add({fromFile:"js/constructor/page.js",title:"setPage stop",desc:"url: "+r})})})}}(),error:function(){return function(t){404===t.status&&o.confirm({title:n("constructor.page not found"),text:n("constructor.page not found and is probaly removed")})}}()})}}(),selectDroppable:function(){return function(e,r){var o=this,n=this.$el;o.$droppableCollection||("block"==e||"favorite-block"==e?o.$droppableCollection=n.find(".ul-container:not(.ul-dragin-helper), .ul-el-drag-mask, .ul-drop-placeholder, header, footer"):"widget"==e?o.$droppableCollection=n.find(".ul-col:not(.ul-absolute-widgets) > .ul-widget:not(.js-draging), .ul-col:not(:has(.ul-widget, .ul-row), .ul-absolute-widgets), .ul-el-drag-mask, .ul-row > .ul-col:not(.ul-absolute-widgets), .ul-drop-placeholder, header, footer"):"absWidget"==e&&(t.each(Object.keys(o.constructor.widgetGlobal.dropPosition[r].position),function(e,i){t.each(o.constructor.widgetGlobal.dropPosition[r].position[i],function(t,e){n.find("#body-fict > .ul-position-absolute-"+i+'[data-position="'+e+'"]:not(.js-draging)').addClass("ul-show-drop-pos").css({width:"",height:""})})}),o.$droppableCollection=n.find(".ul-show-drop-pos")),!t("body").hasClass("ul-left-panel-hide")&&o.$droppableCollection.push(t("body").find(".ul-drop-remove")[0]),o.$droppableCollection=o.$droppableCollection.map(function(){return{$el:t(this)}}),o.dropCollectionToOffsetObjects()),o.$el.on("scroll.onDragEl",o.dropCollectionToOffsetObjects)}}(),startDrop:function(){return function(e,r){var o=this;o.dragEl=!0,o.fixedDrop=!1,o.constructor.widgetGlobal.dropPosition[r]&&o.constructor.widgetGlobal.dropPosition[r].fixed&&(o.fixedDrop=!0,!t("#body-fict").children(".ul-abs-overlay-drag").length&&t("#body-fict").append('<div class="ul-abs-overlay-drag"></div>')),o.selectDroppable(e,r)}}(),isHover:function(){return function(e){this.dragEl=!1,this.constructor.getDragStatus(),t(".ul-elements-controls-visible").removeClass("ul-elements-controls-visible"),t(window).off("fakeEvent"),t(window).on("mousemove.fakeEvent",function(t){e=t}),setTimeout(function(){if(e){var r=jQuery.Event("mouseenter");r.pageX=e.pageX,r.pageY=e.pageY;var o=t(document.elementFromPoint(r.pageX,r.pageY));o=o.closest(".ul-widget, .ul-container, footer, header"),o.trigger(r,"fakeEvent"),t(window).off("fakeEvent")}},400)}}(),stopDrop:function(){return function(){var e=this;if(e.dragEl=!1,t(".ul-abs-overlay-drag",t("#body-fict")).remove(),t(".ul-absolute-widgets").removeClass("ul-show-drop-pos"),e.fixedDrop&&e.$dropTarget){e.$dropTarget.removeAttr("data-title");var r=t(".ul-absolute-widgets:not(:empty)","#body-fict");t.each(r,function(e,r){t(r).css({width:t(r).children(".ul-widget").length?t(r).children(".ul-widget").outerWidth(!0):"",height:t(r).children(".ul-widget").length?t(r).children(".ul-widget").outerHeight(!0):""})}),e.constructor.repositionAbsWidget()}e.startDrag=0,e.fixedDrop=null,e.deselectDroppable(),e.$droppableCollection=null,e.prevPos=null,e.$prevEl=null,e.$restoreEl=null,e.prevRow=!1}}(),autoScrollIframeDrag:function(){return function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:110,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:50,n=this,i=n.$el,a=n.$el.height(),s=1,l=5,u=!1;return 0>e.pageY||t(window).height()<=e.pageY?(clearInterval(n.intTopHandler),clearInterval(n.intBottomHandler),u=!1,n.stopAutoscroll(),!1):(e.pageY<=r?(u=!0,n.stopAutoscroll(),n.intTopHandler=setInterval(function(){i.scrollTop(i.scrollTop()-l),i.scrollTop()==o&&clearInterval(n.intTopHandler)},s)):a-r<=e.pageY?(u=!0,n.stopAutoscroll(),n.intBottomHandler=setInterval(function(){i.scrollTop(i.scrollTop()+l),i.scrollTop()==o&&clearInterval(n.intBottomHandler)},s)):a-r>=e.pageY&&(u=!1),void(!u&&(clearInterval(n.intTopHandler),clearInterval(n.intBottomHandler))))}}(),autoScrollIframeDragReact:function(){return function(e){var r=this,o=r.$el,n=r.$el.height(),i=50,a=110,s=1,l=5,u=!1;return 0>e||t(window).height()<=e?(clearInterval(r.intTopHandler),clearInterval(r.intBottomHandler),u=!1,r.stopAutoscroll(),!1):(a>=e?(u=!0,r.stopAutoscroll(),r.intTopHandler=setInterval(function(){o.scrollTop(o.scrollTop()-l),o.scrollTop()==i&&clearInterval(r.intTopHandler)},s)):e>=n-a?(u=!0,r.stopAutoscroll(),r.intBottomHandler=setInterval(function(){o.scrollTop(o.scrollTop()+l),o.scrollTop()==i&&clearInterval(r.intBottomHandler)},s)):n-a>=e&&(u=!1),void(!u&&(clearInterval(r.intTopHandler),clearInterval(r.intBottomHandler))))}}(),stopAutoscroll:function(){return function(){var t=this;clearInterval(t.intTopHandler),clearInterval(t.intBottomHandler)}}()};return c}),define("sitePublish",["jquery","nf","i18n"],function(t,e,r){var o={publish:function(){return function(e,r,n,i){var a=o;a._checkStatus(e,function(o,s){return o?(i(),void a._showError()):s?n():void t.ajax({url:"/sites/url/"+e+"/setPublished",method:"post",data:{published:!0}}).done(function(t){return t[0]?(i(),a._showError()):void r()}).fail(function(){i(),a._showError()})})}}(),showPublishedWindow:function(){return function(t){var e;try{e=JSON.parse(localStorage.publishCongrats)}catch(r){}e&&e[t]||require(["publishedWindow"],function(e){e.init(t)})}}(),showPublishErrorWindow:function(){return function(){require(["PublishErrorWindow"],function(t){var e=new t;e.show()})}}(),_checkStatus:function(){return function(o,n){t.ajax({url:"/sites/url/"+o+"/getStatus",method:"get"}).done(function(t){return t[0]?n(t[0]):void(0===t[1].status?e.confirm({title:r("all.under construction mode enabled"),text:r("all.are you sure you want to publish your site?"),ok:r("constructor.publish"),cancel:"",okCb:function(){return function(){n()}}(),cancelCb:function(){return function(){n(null,!0)}}()}):1===t[1].status&&n())}).fail(function(){n("error while checking site status")})}}(),_showError:function(){return function(){e.notify(r("constructor.error during site publish"))}}()};return o}),define("blog",["jquery","U","ul-framework","logActions"],function(t,e,r,o){var n={init:function(){return function(e){this.menu=e,t(document).on("beforeChangePage.blogSignal",n.beforeChangePage.bind(n)).on("changePage.blogSignal",n.changePage.bind(n)).on("showBlogPanel.blogSignal",n.showPanel.bind(n)).on("closeBlogPanel.blogSignal",n.closePanel.bind(n)),o.add({fromFile:"js/blog/blog.js",title:"init blog"})}}(),_panelLastState:"closePanel",showPanel:function(){return function(){r.folds.init(),r.range.init(),r.folds.after(),n._panelLastState="showPanel"}}(),closePanel:function(){return function(){n._panelLastState="closePanel"}}(),lastState:"_deinit",beforeChangePage:function(){return function(){var t=e.params.pageType;"blog"===t&&"_init"===n.lastState&&(n._deinit(),n.lastState="_deinit")}}(),changePage:function(){return function(){var r=e.params.pageType;"blog"===r&&require(["blog-body"],function(e){t.extend(n,e),n._init(),n.lastState="_init"})}}(),reinitPanel:function(){return function(){"closePanel"===this._panelLastState&&(this.menu.currentPanel.detach(),this.menu.setPanel("panelBlog"))}}()};return n});var h={clamp:function(){return function(t){return _Mathmin(1,_Mathmax(0,t))}}(),rgb2hex:function(){return function(t){var e=t[0],r=t[1],o=t[2];return e=e.toString(16),r=r.toString(16),o=o.toString(16),1==e.length&&(e="0"+e),1==r.length&&(r="0"+r),1==o.length&&(o="0"+o),("#"+e+r+o).toUpperCase()}}(),hex2rgb:function(){return function(t){4==t.length&&(t=t.replace(/(\w)/g,"$1$1"));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}}(),hsl2rgb:function(){return function(t){function e(t){return t=0>t?t+1:t>1?t-1:t,1>6*t?s+6*((a-s)*t):1>2*t?a:2>3*t?s+6*((a-s)*(2/3-t)):s}var r=t.h,o=t.s,n=t.l,i=t.a;r=r%360/360,o=this.clamp(o),n=this.clamp(n),i=this.clamp(i);var a=.5>=n?n*(o+1):n+o-n*o,s=2*n-a;return{rgb:[_Mathround(255*e(r+1/3)),_Mathround(255*e(r)),_Mathround(255*e(r-1/3))],a:i}}}(),rgb2hsl:function(){return function(t,e){"undefined"==typeof e&&(e=0);var r,o,n=t[0]/255,i=t[1]/255,a=t[2]/255,s=e,l=_Mathmax(n,i,a),u=_Mathmin(n,i,a),c=(l+u)/2,d=l-u;return l===u?r=o=0:(o=c>.5?d/(2-l-u):d/(l+u),l===n?r=(i-a)/d+(a>i?6:0):l===i?r=(a-n)/d+2:l===a?r=(n-i)/d+4:void 0,r/=6),{h:360*r,s:o,l:c,a:s}}}(),rgba2str:function(){return function(t,e){return"rgba("+t[0]+", "+t[1]+", "+t[2]+", "+(e||1)+")"}}(),str2rgb:function(){return function(t){var e;if(t.match(/^rgba/))e=t.match(/^rgba\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);else{if(!t.match(/^rgb\(/))throw new Error("wrong rgb format "+t);e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\s*\)$/)}return{rgb:[e[1],e[2],e[3]],a:e[4]}}}(),darken:function(){return function(t,e){return t.l-=e/100,t.l=this.clamp(t.l),t}}(),lighten:function(){return function(t,e){return t.l+=e/100,t.l=this.clamp(t.l),t}}(),fadein:function(){return function(t,e){return t.a+=e/100,t.a=this.clamp(t.a),t}}(),fadeout:function(){return function(t,e){return t.a-=e/100,t.a=this.clamp(t.a),t}}(),fade:function(){return function(t,e){return t.a=e/100,t.a=this.clamp(t.a),t}}()},___={h:h,fill:function(){return function(t,e,r){var o="",n={},i=null;e.forEach(function(t,e){t.blocks.forEach(function(r,o){n["site_"+e+"_block_"+o]=r.value,r.textColors.forEach(function(r,a){n["site_"+e+"_blocks_"+o+"_"+a]=t.blocks[o].textColors[a],i=e})})}),t.split("\n").forEach(function(t){var e=t.match(/\[.*?site_\d_block.*?\]/g);if(e){var a=e[0].match(/site_(\d){1}_block/)[1];if(a=a?parseInt(a):null,null===a)throw new Error("Stencil parse error "+e[0]);if(a>i)return;var s=0;e.forEach(function(o,i){s=t.indexOf("[",s);var a=t.substr(s+1,t.indexOf("]",s)-s-1),l=a.split("|"),u=l.pop().trim();if(!n[u])return console.error(u),r("Color not defined in colorScheme");var c=n[u];if(0<l.length)if(c.match(/^#/))c=h.rgb2hsl(h.hex2rgb(c));else{if(!c.match(/rgb\(/))return r("unknown color format");var d=h.str2rgb(c);c=h.rgb2hsl(d.rgb,d.a)}for(;0<l.length;){var p=l.pop(),f=p.split(" ");switch(f[0]){case"darken":c=h.darken(c,parseInt(f[1]));break;case"lighten":c=h.lighten(c,parseInt(f[1]));break;case"fade":c=h.fade(c,parseInt(f[1]));break;case"fadein":c=h.fadein(c,parseInt(f[1]));break;case"fadeout":c=h.fadeout(c,parseInt(f[1]))}}if("string"!=typeof c){var g=h.hsl2rgb(c);c=1>c.a?h.rgba2str(g.rgb,g.a):h.rgb2hex(g.rgb)}t=t.replace(e[i],c)}),o+=t+"\n"}else o+=t+"\n"}),r(null,o)}}()};"undefined"==typeof define?module.exports=___:define("js/share/cssStencil",[],function(){return ___}),define("pipette",["jquery","U","js/share/cssStencil"],function(t,e,r){var o={colorScheme:null,stencil:null,currentSiteTheme:null,activateColorSchemeEditMode:function(){return function(e){var r=this;r.bodyClass=t("#body").attr("class"),r.setColorSchemeCss(e,function(){t("[href*='customColorScheme-constructor']").prop("disabled",!0),t("#body").attr("class","g-theme-site-1")})}}(),addConstructorCssLink:function(){return function(r){var o=t("[href*='customColorScheme-constructor'], [href*='main-constructor.css']"),n=t("<link>",{rel:"stylesheet",href:e.params.customCssUrl+"/customColorScheme-constructor.css?v="+Math.random().toString(36).substring(10)});n.load(function(){"function"==typeof r&&r(),o.remove()}),t("head").append(n)}}(),addMainCssLink:function(){return function(r){var o=t("[href*='customColorScheme-constructor'], [href*='main-constructor.css']"),n=t("<link>",{rel:"stylesheet",href:"/templates/"+e.params.template+"/css/main-constructor.css?v="+Math.random().toString(36).substring(10)});n.load(function(){"function"==typeof r&&r(),o.remove()}),t("head").append(n)}}(),destroyColorSchemeEditMode:function(){return function(){var e=this;t("#body").attr("class",e.bodyClass),t("#colorScheme").remove(),t("[href*='customColorScheme-constructor']").prop("disabled",!1)}}(),fillStencil:function(){return function(t,e,o){var n=this;t=[t[e]],r.fill(n.stencil,t,o)}}(),getCurrentSiteTheme:function(){return function(r){var o=this;t.ajax({url:"/sites/url/"+e.params.site+"/pages/id/index/theme",method:"GET",dataType:"json",api:!0,ok:function(){return function(t){var e=t.theme,n=/g-theme-site-(\d)/.exec(e);o.currentSiteTheme=n[1],r()}}()})}}(),loadColorScheme:function(){return function(r){var o=this;t.ajax({url:"/sites/url/"+e.params.site+"/customColorSchemes/getList",method:"GET",dataType:"json",api:!0,ok:function(){return function(t){o.colorScheme=t.data,r()}}()})}}(),loadStencil:function(){return function(r){var o=this;t.ajax({url:"/templates/"+e.params.template+"/css/siteStencil-constructor.css",method:"GET",dataType:"text",success:function(){return function(t){o.stencil=t,"function"==typeof r&&r()}}()})}}(),save:function(){return function(r,o){var n=this;t.ajax({url:"/sites/url/"+e.params.site+"/customColorSchemes/save",method:"POST",dataType:"json",api:!0,contentType:"application/json; charset=utf-8",data:JSON.stringify({data:n.colorScheme,opts:r}),ok:function(){return function(){"function"==typeof o&&o()}}()})}}(),setBlockColor:function(){return function(t,e){var r=this;return r.colorScheme[r.currentSiteTheme-1].blocks[t].value=e,r.colorScheme}}(),setColorSchemeCss:function(){return function(e,r){t("#colorScheme").addClass("colorSchemeToRemove");var o=t("<style>",{id:"colorScheme",type:"text/css",text:e});o.load(function(){"function"==typeof r&&r(),t(".colorSchemeToRemove").remove()}),t("head").append(o)}}(),setTextColor:function(){return function(t,e,r){var o=this;return o.colorScheme[o.currentSiteTheme-1].blocks[t].textColors[e]=r,o.colorScheme}}()};return o}),define("constructorLogger",["jquery","U","_"],function(t,e,r){var o="/sites/url/"+e.params.site,n={log:function(){return function(t){var e=this;t=r.extend({onSuccess:function(){return function(){}}(),onError:function(){return function(){}}()},t);var o=e._actionsRoutes[t.action];return o?void e._send({route:o,data:t.data||{}}):void console.error("invalid log action")}}(),_actionsRoutes:{widgetSearch:o+"/constructorStats/widgetSearch"},_send:function(){return function(e){t.ajax({url:e.route,method:"post",data:e.data}).done(e.onSuccess).fail(e.onError)}}()};return{log:n.log.bind(n),adminLog:function(){return function(r,o,n){t.ajax({type:"post",url:"/sites/url/"+e.params.site+"/pages/id/"+e.params.pageId+"/device_logging",data:{mark:r,data:o},api:!0,ok:function(){return function(){return n()}}(),noOk:function(){return function(t){return n(t)}}()})}}()}}),define("panel",["jquery","lodash","U","history","i18n","ul-framework","nf","model/pages","page","sitePublish","blog","locale","moment","pipette","logActions","ulLoader","constructorLogger"],function(t,e,r,o,n,i,a,s,l,u,c,d,p,f,h,g,m){var v={panels:{current:null},visibleClass:"ul-menu-desc--visible",$el:t("#ul-left-menu"),$main:t(".ul-main-menu","#ul-left-menu"),$content:t(".ul-menu-content","#ul-left-menu"),$undo:t('[data-action="undo"]',".ul-main-menu"),$redo:t('[data-action="redo"]',".ul-main-menu"),tooltipThreshold:[[20,20],[10],[40]],_isPublishing:!1,_prevPcr:1,_currentPcr:1,_longPublication:!1,init:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(){var e,o;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:return e=this,e._historyBtnsLight(),e._addEvents(),e.$content.removeClass("ul-loading-indicator"),e._loadAll(),p.locale(d.get()),e._publish.checkPublishDate(),c.init(this),h.add({fromFile:"js/constructor/menu.js",title:"menu init"}),o=window.constructorPreviewMode?"panelPreview":r.params.panelDefault,t.next=12,e.setPanel(o||"panelPreview");case 12:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),counterCheck:function(){return function(e,o,i){var a=this;o||(o=function(){return function(){}}()),i||(i=function(){return function(){}}()),t.ajax({url:"/sites/url/"+r.params.site+"/getPubCounters",method:"get",api:!0,ok:function(){return function(s){!t("#ul-panelDialog").hasClass(a.visibleClass)&&s.numPublished<a.tooltipThreshold.length&&s.numTooltiped<a.tooltipThreshold[s.numPublished].length&&s.numModified>=a.tooltipThreshold[s.numPublished][s.numTooltiped]&&a._publish.showTooltip(s.numPublished),i(s),r.params.isLandingInTest?a._publish.setInTest():0<s.numModified?a._publish.setPubish():0<s.numPublished&&a._publish.setPubished(),s.isPublishing?(a._publish.publishLoader(),a._pubTimer&&clearTimeout(a._pubTimer),a._pubTimer=setTimeout(function(){a._prevPcr=a._currentPcr,1.15>=a._currentPcr?a._currentPcr+=.01:10>=a._currentPcr?a._currentPcr*=1.25:a._currentPcr=10,a.counterCheck(!1,o)},1e3*a._currentPcr)):(a._pubTimer||e)&&(clearTimeout(a._pubTimer),delete a._pubTimer,clearTimeout(a._publish._publishTimer),delete a._publish._publishTimer,a._currentPcr=1,a._prevPcr=1,a._isPublishing=!1,s.numPublishTrials?g.hide(function(){a.showPublishError(),o([n("constructor.error during site publish"),null])}):(a._longPublication?(a._longPublication=!1,g.hide(function(){a.showPublished()})):a.showPublished(),g.updatePreview(),o()))}}(),noOk:function(){return function(){console.warn("Failed getPubCounters request")}}()}).fail(function(){a._longPublication?(a._longPublication=!1,g.hide(function(){a._publish.setPubish()})):a._publish.setPubish(),console.warn("Failed getPubCounters request")})}}(),_hidePanel:!1,_addEvents:function(){return function(){var e=this;e.counterCheck();var n=function(){return function(e){e.customColorScheme?f.addConstructorCssLink(function(){t("#body").trigger("setSiteSettings.constructor",{id:null,settings:e})}):f.addMainCssLink(function(){t("#body").trigger("setSiteSettings.constructor",{id:null,settings:e})})}}(),i=null;t(document).on("historyBtnsLight",function(){e._historyBtnsLight()}).on("keydown",function(e){t(this).data("disableCtrlZ")||(o.states.length||o.forwardStates.length)&&(1==e.ctrlKey||1==e.metaKey)&&((25==e.charCode||89==e.keyCode)&&e.preventDefault(),(26==e.charCode||90==e.keyCode)&&e.preventDefault(),(26==e.charCode||90==e.keyCode)&&o.states.length&&o.undo(),(25==e.charCode||89==e.keyCode)&&o.forwardStates.length&&o.redo())}).on("click",".js-panel-action",function(){var n=t(this),i=t(this).attr("data-action"),a={undo:function(){return function(){h.add({fromFile:"js/constructor/menu.js",title:"action: "+i,desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId}),o.undo(),window.analyticsHandler("yandexMetrika.mainId","reachGoal","system-history-undo")}}(),redo:function(){return function(){h.add({fromFile:"js/constructor/menu.js",title:"action: "+i,desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId}),o.redo(),window.analyticsHandler("yandexMetrika.mainId","reachGoal","system-history-redo")}}(),publish:function(){return function(){h.add({fromFile:"js/constructor/menu.js",title:"action: "+i,desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId}),v._publish.publish()}}(),panel:function(){return function(){h.add({fromFile:"js/constructor/menu.js",title:"action: "+i+" page: "+n.attr("data-panel"),desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId}),"panelPreview"!==n.attr("data-panel")&&(e._hidePanel||n.attr("data-panel")!==e.panels.current?e._hidePanel&&e.showPanel():e.hidePanel()),null!=e.panels.current&&e.setPanel(n.attr("data-panel")),"panelPreview"===n.attr("data-panel")?r.hist.pushState({data:{url:"/sites/url/"+r.params.site+"/pages/id/"+r.params.pageId+"/preview",panel:"panelPreview"},title:"preview",url:"/sites/url/"+r.params.site+"/pages/id/"+r.params.pageId+"/preview"}):"panelDevice"===n.attr("data-panel")&&m.adminLog("mx panelDevice",{},function(t){t&&console.error("menu logger.adminLog error",t)}),r.constructor.updateAbsGrid()}}(),shopSettings:function(){return function(){require(["shop/settings"],function(t){t.open()})}}(),hideShowPannel:function(){return function(){e._hidePanel?e.showPanel():e.hidePanel(),r.constructor.updateAbsGrid()}}()};null==a[i]?console.warn("undefined action",i):a[i]()}).on("sendPush-changeCustomScheme",function(t,e){e&&"undefined"!=typeof e.customColorScheme&&n(e)}).on("siteChanged",function(t,o){h.add({fromFile:"js/constructor/menu.js",title:"siteChanged",desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId}),i&&clearInterval(i),i=setTimeout(function(){i=null,e.counterCheck()},1e3),o&&"undefined"!=typeof o.customColorScheme&&n(o)}).on("showDropArea",e.dropRemoveEl.show).on("hideDropArea",e.dropRemoveEl.hide).on("click",".js-left-menu.ul-side-menu",function(r){t(r.target).hasClass("js-panel-action")||e._hidePanel&&e.showPanel()}),t(window).on("absWidget singleWidget",function(e,o){var n=t("[data-widget="+o.wtype+"]",".js-panel-constructor-elements");o.active?n.removeAttr("disabled"):n.attr("disabled","disabled"),h.add({fromFile:"js/constructor/menu.js",title:"absWidget singleWidget del/add",desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId})}).on("shopCreated",function(){t('.js-panel-action[data-action="shopSettings"]',e.$el).fadeIn(),t(".ul-eyecatcher-ribbon").addClass("ul-eyecatcher-ribbon-shop"),require(["shop/tooltips/settings"],function(t){t.show()})})}}(),setPanel:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(e){var o;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this.panels.current){t.next=10;break}if(e!==this.panels.current){t.next=3;break}return t.abrupt("return");case 3:if(o=this.panels.current,h.add({fromFile:"js/constructor/menu.js",title:"set panel",desc:"url: /sites/url/"+r.params.site+"/pages/id/"+r.params.pageId+" panelName: "+e}),r.constructor.deviceMode||(r.constructor.deviceMode={}),"panelConstructor"!==e||r.constructor.deviceMode.isPanelConstructorEditable){t.next=9;break}return this.setPanelDevice("panelConstructor"),t.abrupt("return");case 9:"panelConstructor"!==e||r.params.pageIsEditable||this.confirmPanelDevice(o);case 10:return t.next=12,this._loadPanel(e);case 12:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),setPanelDevice:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(e){var i,a=this;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:if(o.clearState(),h.add({fromFile:"js/constructor/menu.js",title:"set panel device"}),i=this.$content.find('[data-target="'+e+'"]'),"panelConstructor"===e){t.next=7;break}return t.next=6,this._loadPanel(e);case 6:return t.abrupt("return");case 7:this.lockPanel(i,{information:{title:n("constructor.lockPanel.title"),iconImage:"/img/constructor/device/modes_constructor.svg"},isCloseLock:!0,button:{visible:!0,classDesign:"ul-button-blue",text:n("constructor.lockPanel.button"),event:{cb:function(){return function(){a.panels[e]&&a.panels[e].initEvent(),"panelConstructor"!==r.params.panelCurrent||r.params.pageIsEditable||a.confirmPanelDevice("panelDevice"),r.constructor.setDevice("desktop",e)}}(),namespace:"lockConstructorModeInDevice"}},beforeOpen:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(){return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a._loadPanel(e);case 2:case"end":return t.stop()}}}(),t,a)}return t}()));return function(){return t.apply(this,arguments)}}()});case 8:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),confirmPanelDevice:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(o){var i=this;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:s.load(r.params.site,function(t){var s=e.findWhere(t,{id:localStorage.previousPageId})||e.findWhere(t,{id:"index"});a.confirm({title:n("all.return to previous page")+' "'+s.title+'"',ok:n("all.return"),cancel:"",okCb:function(){return function(){l.setPage("/sites/url/"+r.params.site+"/pages/id/"+s.id+"/edit",function(){i.setPanel("panelConstructor")}),r.hist.pushState({data:{url:"/sites/url/"+r.params.site+"/pages/id/"+s.id+"/edit"},title:"title",url:"/sites/url/"+r.params.site+"/pages/id/"+s.id+"/constructor"})}}(),cancelCb:function(){return function(){i._loadPanel(o)}}()})});case 1:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),lockPanel:function(){return function(r,o){var n=this;return t(".js-lockPanel",r).length?void o.beforeOpen():void require(["text!html/panelLock.html"],function(i){var a=t(e.template(i,{iconClass:o.information.iconClass,iconImage:o.information.iconImage,title:o.information.title,description:o.information.description,button:o.button})),s=a.appendTo(r);if(o.button.event.cb){var l=o.button.event.cb;o.isCloseLock&&(l=function(){return function(){s.fadeOut("fast",function(){s.remove()}),o.button.event.cb()}}()),s.on("click."+(o.button.event.namespace||"overlayLockPanel"),".js-confirm-lockPanel",l.bind(n))}o.beforeOpen(s)})}}(),currentPanel:{detach:function(){return function(){v.panels[v.panels.current].deinit(v)}}(),attach:function(){return function(){v.panels[v.panels.current].init(v),v._switchActive(v.panels.current)}}(),getPanel:function(){return function(){return v.panels[v.panels.current]}}()},showPublished:function(){return function(){var t=this;t._publish.$el.removeClass("loading").removeClass("disabled"),t._publish.setPublishDate(new Date),t._publish.setPubished(),u.showPublishedWindow(r.params.site)}}(),showPublishError:function(){return function(){var t=this;t._publish.$el.removeClass("disabled"),t._publish.setPubish(),u.showPublishErrorWindow(r.params.site),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--loader-error")}}(),_publish:{$el:t(".js-site-publish",".ul-main-menu"),date:null,setInTest:function(){return function(){this.$el.addClass("ul-site-publish--in-test").attr("title",n("constructor.landing in test")).attr("disabled","disabled")}}(),setPubish:function(){return function(){var t="";this.date?(t=this.getDateFormat(),this.$el.attr("title",n("constructor.last published on DATE",t))):this.$el.attr("title",n("constructor.publish")),this.$el.removeClass("icon-content-special-check ul-site-publish--published").addClass("icon-content-special-publish"),this.$el.hasClass("ul-site-publish--tariffexpired")||this.$el.removeAttr("disabled")}}(),setPubished:function(){return function(){var t=this.getDateFormat();this.$el.attr("title",n("constructor.published")+" "+t),this.$el.removeClass("icon-content-special-publish").addClass("icon-content-special-check ul-site-publish--published").attr("disabled","disabled")}}(),checkPublishDate:function(){return function(){this.date=this.$el.attr("data-date"),this.$el.hasClass("ul-site-publish--published")?this.setPubished():this.setPubish()}}(),publish:function(){return function(){var t=this;if(t.$el.attr("disabled")){if(!t.$el.hasClass("ul-site-publish--tariffexpired")){var e;try{e=JSON.parse(localStorage.publishCongrats)}catch(o){}if(e&&e[r.params.site]){var n=r.params?r.params.siteMainDomain||r.params.siteDomain:window.siteDomain;window.open("http://"+n)}else require(["publishedWindow"],function(t){t.init(r.params.site)})}}else{t.$el.attr("disabled","disabled").addClass("disabled"),t._publishTimer&&(clearTimeout(t._publishTimer),delete t._publishTimer);var i=function(){return function(){t.$el.hasClass("ul-site-publish--tariffexpired")||(t.$el.removeAttr("disabled"),clearTimeout(t._publishTimer),delete t._publishTimer),t.$el.removeClass("disabled"),g.hide()}}();u.publish(r.params.site,function(){v.counterCheck(!0)},i,i)}}}(),publishLoader:function(){return function(){var t=this;t._publishTimer||(t._publishTimer=setTimeout(function(){v._longPublication=!0,g.show({isBlurring:!1,isShowPanel:!1,isShowProgressBar:!0,img:!1,title:"publication.title",text:"publication.text"},{renderIfExist:!1})},0))}}(),setPublishDate:function(){return function(t){var e=this;e.date=t,e.$el.attr("data-date",e.date)}}(),getDateFormat:function(){return function(){return"ru"===d.get()&&p.locale("ru",{calendar:{sameDay:"[сегодня в] LT",nextDay:"[завтра в] LT",lastDay:"[вчера в] LT",nextWeek:function(){return function(){return 2===this.day()?"[во] dddd [в] LT":"[в] dddd [в] LT"}}(),lastWeek:function(){return function(){switch(this.day()){case 0:return"[в прошлое] dddd [в] LT";case 1:case 2:case 4:return"[в прошлый] dddd [в] LT";case 3:case 5:case 6:return"[в прошлую] dddd [в] LT"}}}(),sameElse:"L"}}),p(this.date).calendar()}}(),showTooltip:function(){return function(e){var o=t("#ul-publish-tooltip");if(!o.hasClass("active")&&o.length){var i=function(){return function(e){e.preventDefault(),o.removeClass("active ul-publish-tooltip-active ready").off("click"),t(document).off("click.tooltipPublich"),window.analyticsHandler("facebookPixel.mainId",null,"track","Prompt"),t.ajax({url:"/sites/url/"+r.params.site+"/tooltipShown",method:"post",api:!0,ok:function(){return function(){}}(),noOk:function(){return function(){console.warn("Failed tooltipShown request")}}()})}}();t(".js-site-publish",o).removeClass("icon-content-special-check ul-site-publish--published").addClass("icon-content-special-publish"),o.addClass("active ul-publish-tooltip-active"),t(document).on("click.tooltipPublich",i),e>0&&o.find(".js-publish-tooltip-puttext").text(n("constructor.publish again tooltip")),setTimeout(function(){o.addClass("ready")},500)}}}()},_loadPanel:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function(){function t(e){var o;return regeneratorRuntime.wrap(function(){return function(t){for(;;)switch(t.prev=t.next){case 0:if(this.oldPanel=this.panels.current,this.panels[this.panels.current]&&this.panels[this.panels.current].deinit(v),this.panels.current=null,!this.panels[e]){t.next=7;break}t.t0=this.panels[e],t.next=10;break;case 7:return t.next=9,new Promise(function(t){return require([e],function(e){return t(e)})});case 9:t.t0=t.sent;case 10:return o=t.t0,this.panels[e]||(v.$content.addClass("ul-loading-indicator"),this.panels[e]=o,v.$content.removeClass("ul-loading-indicator")),r.params.panelCurrent=e,this.panels.current=e,this._switchActive(e),o.$el=this.$content.find('[data-target="'+e+'"]'),o.visibleClass=this.visibleClass,t.next=19,o.init(this);case 19:case"end":return t.stop()}}}(),t,this)}return t}()));return function(){return t.apply(this,arguments)}}(),_loadAll:function(){return function(){var t=this;require(["panelConstructor","panelPages","panelDesign","panelPreview","panelDevice"],function(e,r,o,n,i){t.panels.panelConstructor=e,t.panels.panelPages=r,t.panels.panelDesign=o,t.panels.panelPreview=n,t.panels.panelDevice=i})}}(),_historyBtnsLight:function(){return function(){o.states.length?this.$undo.removeAttr("disabled"):this.$undo.attr("disabled","disabled"),o.forwardStates.length?this.$redo.removeAttr("disabled"):this.$redo.attr("disabled","disabled")}}(),dropRemoveEl:{show:function(){return function(){t(".ul-drop-remove").removeClass("ul-drop-remove-hide")}}(),hide:function(){return function(){t(".ul-drop-remove").addClass("ul-drop-remove-hide")}}()},_switchActive:function(){return function(t){v.$main.find('.js-panel-action[data-action="panel"]').removeClass("active").end().find('.js-panel-action[data-panel="'+t+'"]').addClass("active"),v.$content.find("[data-target]").removeClass(this.visibleClass).end().find('[data-target="'+t+'"]').addClass(this.visibleClass)}}(),blockRemove:function(){return function(e){var o=e.attr("data-id");
t.ajax({url:"/api/blanks/site/"+r.params.site+"/removeBlock/"+o+"/",type:"get",success:function(){return function(){e.animate({height:0},500,"linear",function(){t(this).remove()})}}()})}}(),favoriteBlockRemove:function(){return function(e,o){t.ajax({url:"/sites/url/"+r.params.site+"/favoriteBlocks/"+e,type:"delete",api:!0,ok:function(){return function(){o()}}(),noOk:function(){return function(){a.notify(n("constructor.favorite-blocks.block favorites remove error"),"error")}}()})}}(),favoriteBlockEdit:function(){return function(e,o){t.ajax({url:"/sites/url/"+r.params.site+"/favoriteBlocks/"+e.id,type:"put",data:{title:e.title},api:!0,ok:function(){return function(t){o(t)}}(),noOk:function(){return function(){a.notify(n("constructor.favorite-blocks.block favorites edit error"),"error")}}(),error:function(){return function(t){if(500===t.status)throw new Error(t.responseText)}}()})}}(),showPanel:function(){return function(){t(".ul-menu-btn-hidden").removeClass("rotate-arrow"),t("body").removeClass("ul-left-panel-hide"),t("#body").removeClass("ul-left-panel-hide"),this._hidePanel=!1,t(window).trigger("resize").trigger("resizeAllWidgets").trigger("colResized",t("#ul-content")),require(["cropModes"],function(t){t.recalcAll()}),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--panel-show"),window.dispatch(window.actions.toogleShowMenu(!0))}}(),hidePanel:function(){return function(){t(".ul-menu-btn-hidden").addClass("rotate-arrow"),t("body").addClass("ul-left-panel-hide"),t("#body").addClass("ul-left-panel-hide"),this._hidePanel=!0,t(window).trigger("resize").trigger("resizeAllWidgets").trigger("colResized",t("#ul-content")),require(["cropModes"],function(t){t.recalcAll()}),window.analyticsHandler("yandexMetrika.mainId","reachGoal","client--panel-hide"),window.dispatch(window.actions.toogleShowMenu(!1))}}()};return v});
//# sourceMappingURL=app.build.js.map
